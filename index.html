<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>DPbot Secure Test Environment</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #1a1a2e;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
        }
        .container {
            background-color: #16213e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            width: 90%;
            max-width: 800px;
        }
        .hidden {
            display: none;
        }
        h2 {
            color: #e94560;
        }
        button.register {
            background-color: #888;
            color: #ccc;
            cursor: not-allowed;
            border: none;
            padding: 12px 20px;
            margin: 8px;
            border-radius: 8px;
            font-size: 16px;
            transition: background-color 0.5s ease;
        }
        button.register.enabled {
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
        button.register.enabled:hover {
            background-color: #218838;
        }
        #countdown-text {
            color: #e94560;
            font-size: 18px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="main-container" class="container hidden">
        <h2>Welcome to DPbot Test Rocket</h2>
        <p id="countdown-text">Register button will be active in <span id="countdown-timer">5</span>s</p>
        <button class="register" disabled>Register</button>
    </div>

    <div id="enable-bot-prompt" class="container">
        <h2>Please Enable DPbot Extension</h2>
        <p>This test page requires the DPbot extension to be active. Please turn on the bot from the extension popup.</p>
    </div>

    <script>
        const mainContainer = document.getElementById('main-container');
        const enableBotPrompt = document.getElementById('enable-bot-prompt');
        const registerBtn = document.querySelector('.register');
        const countdownText = document.getElementById('countdown-text');
        const timerSpan = document.getElementById('countdown-timer');

        // This function repeatedly checks for the bot's "footprint"
        const checkForBot = setInterval(() => {
            if (document.body.dataset.dpbotEnabled === 'true') {
                clearInterval(checkForBot); // Stop checking
                enableBotPrompt.classList.add('hidden'); // Hide the prompt
                mainContainer.classList.remove('hidden'); // Show the main test site
                startCountdown(); // Start the countdown
            }
        }, 500); // Check every half-second

        // This function starts the countdown and enables the button
        function startCountdown() {
            let seconds = 5;
            timerSpan.textContent = seconds;

            const interval = setInterval(() => {
                seconds--;
                timerSpan.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(interval);
                    countdownText.textContent = 'Register is now open!';
                    registerBtn.classList.add('enabled');
                    registerBtn.disabled = false;
                }
            }, 1000);
        }
    </script>
</body>
</html>